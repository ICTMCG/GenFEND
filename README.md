# GenFEND
Let Silence Speak: Enhancing Fake News Detection with Generated Comments from Large Language Models (ACM CIKM 2024 Research Track Paper)

[Preprint](https://arxiv.org/pdf/2405.16631)
[Chinese Blog](https://mp.weixin.qq.com/s/ClcpdlO3iZPcnm_v_ryHLA)

# Data Preparation
The `/data/` folder in `GenFEND_release_ch` and `GenFEND_release_en` is where the data used for training and testing is stored. 

For `GenFEND_release_ch`, we experiment on [**Weibo21**](https://dl.acm.org/doi/abs/10.1145/3459637.3482139).
The folder `/data/Weibo21/` contains the data with real comments, and the folder `/data/Weibo21/Dmeta-embedding-comments-feature/` contains the extracted feature of real comments.
the folder `/data/role_virtual_comments/` contains the Weibo21 data with generated comments and the corresponding extracted comment feature.

For `GenFEND_release_en`, we experiment on [**LLM-mis**](https://openreview.net/forum?id=ccxD4mtkTU) and [**GossipCop**](https://www.liebertpub.com/doi/abs/10.1089/big.2020.0062).
The folder `/data/LLM-mis/` contains the LLM-mis data with generated comments, and the folder `/data/LLM-mis/bge-large-en-v1.5/` contains the extracted feature of generated comments.
The folder `/data/GossipCop/` contains the GossipCop data with real comments, the folder `data/GossipCop/bge-large-en-v1.5/` contains the extracted feature of real comments, and the folder `/data/role_virtual_comments/` contains the GossipCop data with generated comments and the corresponding extracted comment feature.

<font color = 'red'>**Note**</font> that we only list some example instances in `train.json`, `val.json`, and `test.json`.
You should prepare the whole dataset in the same format as example instances, and follow **STEP I** in the **How To Run** section to generate the complete dataset.

# Sentence Encoder Preparation
Download model files from [Dmeta-embedding](https://huggingface.co/DMetaSoul/Dmeta-embedding-zh/tree/main) and put them in the folder `GenFEND_release_ch/pretrained_model/Dmeta-embedding/`.

Download model files from [bge-large-en-v1.5](https://huggingface.co/BAAI/bge-large-en-v1.5/tree/main) and put them in the folder `GenFEND_release_en/pretrained_model/bge-large-en-v1.5/`. 


# How To Run
**STEP I: Comment Encoding**

Go to the folder `GenFEND_release_ch/data/` or `GenFEND_release_en/data/` and run the following command:
```
python cmts_fea_ext.py
python add_file_index.py
```
**STEP II: Training and Testing**

To experiment on the Weibo21 dataset, go to the folder `GenFEND_release_ch` and run the following command:
```
python main.py --model_name bert_genfend 
```
or
```
python main.py --model_name defend_genfend 
```
To experiment on the GossipCop dataset, go to the folder `GenFEND_release_en` and run the following command:
```
python main.py --root_path './data/GossipCop/' --model_name bert_genfend
```
or
```
python main.py --root_path './data/GossipCop/' --model_name defend_genfend 
```
To experiment on the LLM-mis dataset, go to the folder `GenFEND_release_en` and run the following command:
```
python main.py --root_path './data/LLM-mis/' --model_name bert_genfend
```
# How To Integrate with Other Models
`MultiSubpp.py` serves as a plug-in module for integrating with both content-only and comment-based models.

Refer to the *MultiSubppModel* used in `BERTMtiSppModel.py` and `dEFENDMtiSppModel.py` to see how to integrate with the other models.

# How To Cite
```
@inproceedings{nan2024let,
  title={{Let Silence Speak: Enhancing Fake News Detection with Generated Comments from Large Language Models}},
  author={Nan, Qiong and Sheng, Qiang and Cao, Juan and Hu, Beizhe and Wang, Danding and Li, Jintao},
  booktitle={Proceedings of the 33rd ACM International Conference on Information and Knowledge Management},
  pages = {1732â€“1742},
  doi={10.1145/3627673.3679519},
  year={2024}
}
```

# Relevant Resources
- Paper List ``LLM-for-misinformation-research``: https://github.com/ICTMCG/LLM-for-misinformation-research/
- Tutorial @SIGIR 2024 ``Preventing and Detecting Misinformation Generated by Large Language Models``: https://sigir24-llm-misinformation.github.io/
